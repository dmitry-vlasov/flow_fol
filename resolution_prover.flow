import fs/filesystem;
import fol_parser;
import fol_resolution;

main() {
	Peano_ax = map(Peano_ax_src, \ax -> parseFolFormulaDef(ax, FolFalse()));
	println("Peano axioms: ");
	iter(Peano_ax, \ax -> println("\t" + formula2string(ax)));
	Peano_tests = map(Peano_tests_src, \t -> parseFolFormulaDef(t, FolFalse()));
	iter(Peano_tests, 
		\test -> {
			println("Does Peano axioms imply: " + formula2string(test) + "?");
			println("\t" + (if (resolutionEntailment(Peano_ax, test)) "YES" else "NO"));
		}
	)
}

Peano_ax_src = [
	"A x. +(x, 0(), x)", 
	"A x. A y. A z. (+(x, y, z) -> +(x, s(y), s(z)))",
	"A x. *(x, 0(), 0())", 
	"A x. *(x, s(0()), x)", 
	"A x. A y. A z. (E t. (+(t, x, z) & *(x, y, t)) -> *(x, s(y), z))",
	"A x. (E y. +(y, y, x) -> even(x))",
];

Peano_tests_src = [
	"+(s(0()), s(0()), 0())",
	"+(s(0()), s(0()), s(s(0())))",
	"+(s(0()), s(0()), s(0()))",
	"+(s(0()), s(0()), s(s(s(0()))))",
	"+(s(s(0())), s(s(0())), s(s(s(s(0())))))",
	
	"*(s(s(0())), s(0()), s(s(0())))",
	"*(s(0()), s(s(0())), s(s(0())))",
	"*(s(s(0())), s(s(0())), s(s(s(s(0())))))",
	"*(s(s(0())), s(s(0())), s(s(s(0()))))",
	"*(s(s(0())), s(s(0())), s(s(s(s(s(0()))))))",

	"even(0())",
	"even(s(0()))",
	"even(s(s(0())))",
	"even(s(s(s(0()))))",
];
